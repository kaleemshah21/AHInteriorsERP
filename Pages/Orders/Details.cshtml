@page
@model AHInteriorsERP.Pages.Orders.DetailsModel

@{
    ViewData["Title"] = "Details";
}

<h1>Details</h1>

<div>
    <h4>Order</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Order.OrderDate)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Order.OrderDate)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Order.Status)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Order.Status)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Order.Notes)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Order.Notes)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Order.Customer)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Order.Customer.CustomerName)
        </dd>
    </dl>
</div>
<hr />

<h5 class="mt-3 mb-2">Order Items</h5>

<div class="table-responsive">
    <table class="table">
        <thead>
            <tr>
                <th>SKU</th>
                <th>Product</th>
                <th class="text-end">Unit Price</th>
                <th class="text-end">Qty</th>
                <th class="text-end">Line Total</th>
            </tr>
        </thead>
        <tbody>
            @if (Model.Order.OrderItems == null || !Model.Order.OrderItems.Any())
            {
                <tr>
                    <td colspan="5" class="text-muted">No items found for this order.</td>
                </tr>
            }
            else
            {
                foreach (var item in Model.Order.OrderItems)
                {
                    <tr>
                        <td>@(item.Product?.SKU ?? "-")</td>
                        <td>@(item.Product?.ProductName ?? "-")</td>
                        <td class="text-end">£@item.UnitPriceAtTime.ToString("0.00")</td>
                        <td class="text-end">@item.Quantity</td>
                        <td class="text-end">£@((item.Quantity * item.UnitPriceAtTime).ToString("0.00"))</td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>

<div class="text-end mt-2">
    <strong>Order Total:</strong> £@Model.OrderTotal.ToString("0.00")
</div>

<div>
    <a asp-page="./Edit" asp-route-id="@Model.Order.OrderID">Edit</a> |
    <a asp-page="./Index">Back to List</a>
</div>
